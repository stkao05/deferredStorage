var idbKeyval=function(){"use strict";return{pending:{},lastSetTime:{},timeout:100,setWhenIdle:function(i,e){var n=this,t=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).timeout,o=this.pending[i];if(o)return o.value=e,o.promise;t=void 0===t?this.timeout:t,o={};var r=new Promise(function(e,i){o={resolve:e,reject:i}}),l=window.requestIdleCallback(function(e){return n.processPending(i,e)},{timeout:t});return o.id=l,o.value=e,o.promise=r,o.timeout=t,this.pending[i]=o,r},processPending:function(i,e){var n=this;if(this.pending[i]){var t=this.pending[i],o=t.value,r=t.resolve,l=t.reject,a=t.timeout;if(void 0===o)return window.localStorage.removeItem(i),delete this.pending[i],void r();if(void 0!==this.lastSetTime[i]&&this.lastSetTime[i]>e.timeRemaining&&!e.didTimeout){var d=window.requestIdleCallback(function(e){return n.processPending(i,e)},{timeout:a});this.pending[i].id=d}else try{var s=Date.now(),c=JSON.stringify(o);if(void 0===c)throw new Error("Non JSON serializable value");window.localStorage.setItem(i,c);var u=Date.now();this.lastSetTime[i]=u-s,r()}catch(e){l(e)}finally{delete this.pending[i]}}},hasPending:function(){return 0<Object.keys(this.pending).length},get:function(e){var i=window.localStorage.getItem(e);return null===i?null:JSON.parse(i)},remove:function(e){if(window.localStorage.removeItem(e),this.pending[e]){var i=this.pending[e],n=i.id;(0,i.resolve)(),window.cancelIdleCallback(n),delete this.pending[e]}},commit:function(){for(var e in this.pending){var i=this.pending[e],n=i.id,t=i.value,o=i.resolve,r=i.reject;if(void 0===t)window.localStorage.removeItem(e),o();else try{var l=JSON.stringify(t);if(void 0===l)throw new Error("Non JSON serializable value");window.localStorage.setItem(e,l),o()}catch(e){r(e)}window.cancelIdleCallback(n)}this.pending={}},clear:function(){for(var e in window.localStorage.clear(),this.pending)this.pending[e].resolve(),window.cancelIdleCallback(this.pending[e].id);this.pending={}}}}();